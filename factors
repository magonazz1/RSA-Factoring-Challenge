#!/usr/bin/env python3

import sys
from sympy import factorint

def main(file_path):
    try:
        with open(file_path, 'r') as file:
            lines = file.read().splitlines()
            for line in lines:
                number = int(line)
                if number < 2:
                    print(f"Skipping {number} as it's not a natural number greater than 1.")
                    continue

                factors = factorint(number)
                if factors:
                    factor_pairs = [(p, factors[p]) for p in factors]
                    print(f"{number} = {' * '.join([f'{p}^{e}' for p, e in factor_pairs])}")
                else:
                    print(f"Unable to factorize {number}.")
    except FileNotFoundError:
        print(f"File '{file_path}' not found.")
    except ValueError:
        print("Invalid input in the file. All lines must contain natural numbers greater than 1.")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: factors <file>")
    else:
        file_path = sys.argv[1]
        main(file_path)
